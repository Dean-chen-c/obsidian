## 正向代理

一个位于客户端和原始[服务器](https://cloud.tencent.com/act/pro/promotion-cvm?from_column=20065&from=20065)(origin server)之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标(原始服务器)，然后代理向原始服务器转交请求并将获得的内容返回给客户端。

客户端才能使用正向代理。正向代理总结就一句话：代理端代理的是客户端。例如说：我们使用的OpenVPN 等等。

> 例如：在大陆访问www.google.com，我们需要一个代理服务器，我们通过代理服务器去访问谷歌，这个过程就是正向代理。

正向代理，代理的是客户端，服务端不知道实际发起请求的客户端

## 反向代理

反向代理（Reverse Proxy）方式，是指以代理服务器来接受 Internet上的连接请求，然后将请求，发给内部网络上的服务器并将从服务器上得到的结果返回给 Internet 上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器。

反向代理，代理的是服务端，客户端不知道实际提供服务的服务端

> 都是站在客户端的角度，看代理服务器是帮客户端代理，还是帮服务端代理
> 
> 正向代理，就是`代理服务器代理了客户端`，去和目标服务器进行交互。现实生活中的场景：黄牛买票。 反向代理，就是`代理服务器代理了目标服务器`，去和客户端进行交互。现实生活中的场景：房屋中介。

## nginx反向代理匹配规则

### 匹配规则总结

**location 是否以“／”结尾，在 ngnix 中 location 进行的是模糊匹配**

1. 没有“/”结尾时，location /abc/def 可以匹配 /abc/defghi 请求，也可以匹配 /abc/def/ghi等
2. 而有“/”结尾时，location /abc/def/ 不能匹配 /abc/defghi 请求，只能匹配 /abc/def/anything 这样的proxy_pass配置规则

**配置 proxy_pass 时**

1. Nginx 不会把 location 中匹配的路径部分加入代理 uri
	1. 当proxy_pass后面的 url 加上了 /，相当于是绝对路径
	2. 当proxy_pass 为 IP或域名+端口+路径（结尾不管有无/）
2. Nginx 会把 location 中匹配的路径部分加入代理 uri
	1. 当proxy_pass 为 IP或域名+端口（结尾无/）