
[åŸæ–‡](https://juejin.cn/post/7033275515880341512)

- [[#ğŸŒŸ promise|ğŸŒŸ promise]]
	- [[#ğŸŒŸ promise#å®ç°[[Promise]]|å®ç°[[Promise]]]]
	- [[#ğŸŒŸ promise#å®ç°promise.all|å®ç°promise.all]]
	- [[#ğŸŒŸ promise#å®ç° promise.finally|å®ç° promise.finally]]
	- [[#ğŸŒŸ promise#å®ç°promise.allSettled|å®ç°promise.allSettled]]
	- [[#ğŸŒŸ promise#å®ç°promise.race|å®ç°promise.race]]
	- [[#ğŸŒŸ promise#promise.any|promise.any]]
	- [[#ğŸŒŸ promise#resolve|resolve]]
	- [[#ğŸŒŸ promise#reject|reject]]
- [[#ğŸ³ Arrayç¯‡|ğŸ³ Arrayç¯‡]]
	- [[#ğŸ³ Arrayç¯‡#æ•°ç»„å»é‡|æ•°ç»„å»é‡]]
		- [[#æ•°ç»„å»é‡#ä½¿ç”¨åŒé‡Â `for`Â å’ŒÂ `splice`|ä½¿ç”¨åŒé‡Â `for`Â å’ŒÂ `splice`]]
		- [[#æ•°ç»„å»é‡#ä½¿ç”¨Â `indexOf`Â æˆ–Â `includes`Â åŠ æ–°æ•°ç»„|ä½¿ç”¨Â `indexOf`Â æˆ–Â `includes`Â åŠ æ–°æ•°ç»„]]
		- [[#æ•°ç»„å»é‡#`sort`Â æ’åºåï¼Œä½¿ç”¨å¿«æ…¢æŒ‡é’ˆçš„æ€æƒ³|`sort`Â æ’åºåï¼Œä½¿ç”¨å¿«æ…¢æŒ‡é’ˆçš„æ€æƒ³]]
		- [[#æ•°ç»„å»é‡#`ES6`Â æä¾›çš„Â `Set`Â å»é‡|`ES6`Â æä¾›çš„Â `Set`Â å»é‡]]
		- [[#æ•°ç»„å»é‡#ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ æ˜¯å¦å‡ºç°(`ES6`Â æä¾›çš„Â `map`)|ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ æ˜¯å¦å‡ºç°(`ES6`Â æä¾›çš„Â `map`)]]
		- [[#æ•°ç»„å»é‡#`filter`Â é…åˆÂ `indexOf`|`filter`Â é…åˆÂ `indexOf`]]
		- [[#æ•°ç»„å»é‡#`reduce`Â é…åˆÂ `includes`|`reduce`Â é…åˆÂ `includes`]]
	- [[#ğŸ³ Arrayç¯‡#æ•°ç»„æ‰å¹³åŒ–|æ•°ç»„æ‰å¹³åŒ–]]
		- [[#æ•°ç»„æ‰å¹³åŒ–#ç”¨Â `reduce`Â å®ç°Â `flat`Â å‡½æ•°|ç”¨Â `reduce`Â å®ç°Â `flat`Â å‡½æ•°]]
		- [[#æ•°ç»„æ‰å¹³åŒ–#ä½¿ç”¨æ ˆçš„æ€æƒ³å®ç°Â `flat`Â å‡½æ•°|ä½¿ç”¨æ ˆçš„æ€æƒ³å®ç°Â `flat`Â å‡½æ•°]]
		- [[#æ•°ç»„æ‰å¹³åŒ–#ä½¿ç”¨Â `Generator`Â å®ç°Â `flat`Â å‡½æ•°|ä½¿ç”¨Â `Generator`Â å®ç°Â `flat`Â å‡½æ•°]]
		- [[#æ•°ç»„æ‰å¹³åŒ–#å®ç°åœ¨åŸå‹é“¾ä¸Šé‡å†™Â `flat`Â å‡½æ•°|å®ç°åœ¨åŸå‹é“¾ä¸Šé‡å†™Â `flat`Â å‡½æ•°]]
	- [[#ğŸ³ Arrayç¯‡#forEach|forEach]]
	- [[#ğŸ³ Arrayç¯‡#reduce|reduce]]
	- [[#ğŸ³ Arrayç¯‡#map|map]]
	- [[#ğŸ³ Arrayç¯‡#every|every]]
	- [[#ğŸ³ Arrayç¯‡#some|some]]
	- [[#ğŸ³ Arrayç¯‡#find/findIndex|find/findIndex]]
	- [[#ğŸ³ Arrayç¯‡#indexOf|indexOf]]
- [[#å®ç°sort [èƒ½ä¸èƒ½å®ç°æ•°ç»„sortæ–¹æ³•](https://juejin.cn/post/6844903986479251464#heading-33)|å®ç°sort [èƒ½ä¸èƒ½å®ç°æ•°ç»„sortæ–¹æ³•](https://juejin.cn/post/6844903986479251464#heading-33)]]
- [[#ğŸŒŠ é˜²æŠ–èŠ‚æµ|ğŸŒŠ é˜²æŠ–èŠ‚æµ]]
	- [[#ğŸŒŠ é˜²æŠ–èŠ‚æµ#å®ç°é˜²æŠ–å‡½æ•°debounce|å®ç°é˜²æŠ–å‡½æ•°debounce]]
	- [[#ğŸŒŠ é˜²æŠ–èŠ‚æµ#å®ç°èŠ‚æµå‡½æ•°throttle|å®ç°èŠ‚æµå‡½æ•°throttle]]
- [[#â›² Objectç¯‡|â›² Objectç¯‡]]
	- [[#â›² Objectç¯‡#èƒ½ä¸èƒ½å†™ä¸€ä¸ªå®Œæ•´çš„æ·±æ‹·è´[æ–‡ç« ](https://juejin.cn/post/6844903986479251464#heading-56)|èƒ½ä¸èƒ½å†™ä¸€ä¸ªå®Œæ•´çš„æ·±æ‹·è´[æ–‡ç« ](https://juejin.cn/post/6844903986479251464#heading-56)]]
	- [[#â›² Objectç¯‡#å®ç°new|å®ç°new]]
	- [[#â›² Objectç¯‡#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)|ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#åŸå‹é“¾ç»§æ‰¿|åŸå‹é“¾ç»§æ‰¿]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#å€Ÿç”¨æ„é€ å‡½æ•°(ç»å…¸ç»§æ‰¿)|å€Ÿç”¨æ„é€ å‡½æ•°(ç»å…¸ç»§æ‰¿)]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#ç»„åˆç»§æ‰¿|ç»„åˆç»§æ‰¿]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#åŸå‹å¼ç»§æ‰¿|åŸå‹å¼ç»§æ‰¿]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#å¯„ç”Ÿå¼ç»§æ‰¿|å¯„ç”Ÿå¼ç»§æ‰¿]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿|å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿]]
		- [[#ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)#Classå®ç°ç»§æ‰¿(è¡¥å……ä¸€ä¸‹)|Classå®ç°ç»§æ‰¿(è¡¥å……ä¸€ä¸‹)]]
	- [[#â›² Objectç¯‡#å®ç°object.create|å®ç°object.create]]
- [[#ğŸš‚ Functionç¯‡|ğŸš‚ Functionç¯‡]]
	- [[#ğŸš‚ Functionç¯‡#call|call]]
	- [[#ğŸš‚ Functionç¯‡#bind|bind]]
	- [[#ğŸš‚ Functionç¯‡#apply|apply]]
	- [[#ğŸš‚ Functionç¯‡#å®ç°æŸ¯é‡ŒåŒ–[JavaScript ä¸“é¢˜ä¹‹å‡½æ•°æŸ¯é‡ŒåŒ–](https://juejin.cn/post/6844903490771222542#heading-5)|å®ç°æŸ¯é‡ŒåŒ–[JavaScript ä¸“é¢˜ä¹‹å‡½æ•°æŸ¯é‡ŒåŒ–](https://juejin.cn/post/6844903490771222542#heading-5)]]
	- [[#ğŸš‚ Functionç¯‡#å®ç°é“¾å¼è°ƒç”¨[æ–‡ç« ](https://github.com/zcxiaobao/everyday-insist/blob/master/21interview/imitate/chainFunc.md)|å®ç°é“¾å¼è°ƒç”¨[æ–‡ç« ](https://github.com/zcxiaobao/everyday-insist/blob/master/21interview/imitate/chainFunc.md)]]
	- [[#ğŸš‚ Functionç¯‡#åå‡½æ•°(æ–‡ç« )[https://juejin.cn/post/6946022649768181774#heading-17]|åå‡½æ•°(æ–‡ç« )[https://juejin.cn/post/6946022649768181774#heading-17]]]
- [[#ğŸŒ ajax ä¸ jsonp|ğŸŒ ajax ä¸ jsonp]]
	- [[#ğŸŒ ajax ä¸ jsonp#å®ç°ajax|å®ç°ajax]]
	- [[#ğŸŒ ajax ä¸ jsonp#å®ç°jsonp|å®ç°jsonp]]
- [[#ğŸ›« ES6ç¯‡|ğŸ›« ES6ç¯‡]]
	- [[#ğŸ›« ES6ç¯‡#å®ç°set|å®ç°set]]
	- [[#ğŸ›« ES6ç¯‡#å®ç° map|å®ç° map]]
- [[#ğŸ¦‰ å…¶ä»–|ğŸ¦‰ å…¶ä»–]]
	- [[#ğŸ¦‰ å…¶ä»–#instanceof|instanceof]]
	- [[#ğŸ¦‰ å…¶ä»–#å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦|å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦]]
	- [[#ğŸ¦‰ å…¶ä»–#æŠŠä¸€ä¸ªJSONå¯¹è±¡çš„keyä»ä¸‹åˆ’çº¿å½¢å¼ï¼ˆPascalï¼‰è½¬æ¢åˆ°å°é©¼å³°å½¢å¼ï¼ˆCamelï¼‰[æ–‡ç« ](https://github.com/zcxiaobao/everyday-insist/blob/master/21interview/baseJS/_tocamel.md)|æŠŠä¸€ä¸ªJSONå¯¹è±¡çš„keyä»ä¸‹åˆ’çº¿å½¢å¼ï¼ˆPascalï¼‰è½¬æ¢åˆ°å°é©¼å³°å½¢å¼ï¼ˆCamelï¼‰[æ–‡ç« ](https://github.com/zcxiaobao/everyday-insist/blob/master/21interview/baseJS/_tocamel.md)]]
	- [[#ğŸ¦‰ å…¶ä»–#å®ç°æ•°æ®ç±»å‹åˆ¤æ–­å‡½æ•°typeof|å®ç°æ•°æ®ç±»å‹åˆ¤æ–­å‡½æ•°typeof]]
	- [[#ğŸ¦‰ å…¶ä»–#å®ç°æ•°ç»„è½¬æ ‘[æ–‡ç« ](https://github.com/lgwebdream/FE-Interview/issues/35)|å®ç°æ•°ç»„è½¬æ ‘[æ–‡ç« ](https://github.com/lgwebdream/FE-Interview/issues/35)]]
	- [[#ğŸ¦‰ å…¶ä»–#å®ç°sleepå‡½æ•°|å®ç°sleepå‡½æ•°]]
	- [[#ğŸ¦‰ å…¶ä»–#å®ç°å‘å¸ƒè®¢é˜…æ¨¡å¼|å®ç°å‘å¸ƒè®¢é˜…æ¨¡å¼]]


## ğŸŒŸ promise

### å®ç°[[Promise]]

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­â­)

```js
// å…ˆå®šä¹‰ä¸‰ä¸ªå¸¸é‡è¡¨ç¤ºçŠ¶æ€
const PENDING = 'pending';
const FULFILLED = 'fulfilled';
const REJECTED = 'rejected';

// æ–°å»º MyPromise ç±»
class MyPromise {
  constructor(executor){
    // executor æ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œè¿›å…¥ä¼šç«‹å³æ‰§è¡Œ
    // å¹¶ä¼ å…¥resolveå’Œrejectæ–¹æ³•
    try {
      executor(this.resolve, this.reject)
    } catch (error) {
      this.reject(error)
    }
  }

  // å‚¨å­˜çŠ¶æ€çš„å˜é‡ï¼Œåˆå§‹å€¼æ˜¯ pending
  status = PENDING;

  // resolveå’Œrejectä¸ºä»€ä¹ˆè¦ç”¨ç®­å¤´å‡½æ•°ï¼Ÿ
  // å¦‚æœç›´æ¥è°ƒç”¨çš„è¯ï¼Œæ™®é€šå‡½æ•°thisæŒ‡å‘çš„æ˜¯windowæˆ–è€…undefined
  // ç”¨ç®­å¤´å‡½æ•°å°±å¯ä»¥è®©thisæŒ‡å‘å½“å‰å®ä¾‹å¯¹è±¡
  // æˆåŠŸä¹‹åçš„å€¼
  value = null;
  // å¤±è´¥ä¹‹åçš„åŸå› 
  reason = null;

  // å­˜å‚¨æˆåŠŸå›è°ƒå‡½æ•°
  onFulfilledCallbacks = [];
  // å­˜å‚¨å¤±è´¥å›è°ƒå‡½æ•°
  onRejectedCallbacks = [];

  // æ›´æ”¹æˆåŠŸåçš„çŠ¶æ€
  resolve = (value) => {
    // åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹
    if (this.status === PENDING) {
      // çŠ¶æ€ä¿®æ”¹ä¸ºæˆåŠŸ
      this.status = FULFILLED;
      // ä¿å­˜æˆåŠŸä¹‹åçš„å€¼
      this.value = value;
      // resolveé‡Œé¢å°†æ‰€æœ‰æˆåŠŸçš„å›è°ƒæ‹¿å‡ºæ¥æ‰§è¡Œ
      while (this.onFulfilledCallbacks.length) {
        // Array.shift() å–å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åï¼ˆï¼‰è°ƒç”¨ï¼Œshiftä¸æ˜¯çº¯å‡½æ•°ï¼Œå–å‡ºåï¼Œæ•°ç»„å°†å¤±å»è¯¥å…ƒç´ ï¼Œç›´åˆ°æ•°ç»„ä¸ºç©º
        this.onFulfilledCallbacks.shift()(value)
      }
    }
  }

  // æ›´æ”¹å¤±è´¥åçš„çŠ¶æ€
  reject = (reason) => {
    // åªæœ‰çŠ¶æ€æ˜¯ç­‰å¾…ï¼Œæ‰æ‰§è¡ŒçŠ¶æ€ä¿®æ”¹
    if (this.status === PENDING) {
      // çŠ¶æ€æˆåŠŸä¸ºå¤±è´¥
      this.status = REJECTED;
      // ä¿å­˜å¤±è´¥åçš„åŸå› 
      this.reason = reason;
      // resolveé‡Œé¢å°†æ‰€æœ‰å¤±è´¥çš„å›è°ƒæ‹¿å‡ºæ¥æ‰§è¡Œ
      while (this.onRejectedCallbacks.length) {
        this.onRejectedCallbacks.shift()(reason)
      }
    }
  }

  then(onFulfilled, onRejected) {
    const realOnFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;
    const realOnRejected = typeof onRejected === 'function' ? onRejected : reason => {throw reason};

    // ä¸ºäº†é“¾å¼è°ƒç”¨è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ª MyPromiseï¼Œå¹¶åœ¨åé¢ return å‡ºå»
    const promise2 = new MyPromise((resolve, reject) => {

      const fulfilledMicrotask = () =>  {
        // åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–
        queueMicrotask(() => {
          try {
            // è·å–æˆåŠŸå›è°ƒå‡½æ•°çš„æ‰§è¡Œç»“æœ
            const x = realOnFulfilled(this.value);
            // ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†
            resolvePromise(promise2, x, resolve, reject);
          } catch (error) {
            reject(error)
          } 
        })  
      }

      const rejectedMicrotask = () => { 
        // åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ç­‰å¾… promise2 å®Œæˆåˆå§‹åŒ–
        queueMicrotask(() => {
          try {
            // è°ƒç”¨å¤±è´¥å›è°ƒï¼Œå¹¶ä¸”æŠŠåŸå› è¿”å›
            const x = realOnRejected(this.reason);
            // ä¼ å…¥ resolvePromise é›†ä¸­å¤„ç†
            resolvePromise(promise2, x, resolve, reject);
          } catch (error) {
            reject(error)
          } 
        }) 
      }
      // åˆ¤æ–­çŠ¶æ€
      if (this.status === FULFILLED) {
        fulfilledMicrotask() 
      } else if (this.status === REJECTED) { 
        rejectedMicrotask()
      } else if (this.status === PENDING) {
        // ç­‰å¾…
        // å› ä¸ºä¸çŸ¥é“åé¢çŠ¶æ€çš„å˜åŒ–æƒ…å†µï¼Œæ‰€ä»¥å°†æˆåŠŸå›è°ƒå’Œå¤±è´¥å›è°ƒå­˜å‚¨èµ·æ¥
        // ç­‰åˆ°æ‰§è¡ŒæˆåŠŸå¤±è´¥å‡½æ•°çš„æ—¶å€™å†ä¼ é€’
        this.onFulfilledCallbacks.push(fulfilledMicrotask);
        this.onRejectedCallbacks.push(rejectedMicrotask);
      }
    }) 
    
    return promise2;
  }

  catch (onRejected) {
    // åªéœ€è¦è¿›è¡Œé”™è¯¯å¤„ç†
    this.then(undefined, onRejected);
  }

  finally (fn) {
    return this.then((value) => {
      return MyPromise.resolve(fn()).then(() => {
        return value;
      });
    }, (error) => {
      return MyPromise.resolve(fn()).then(() => {
        throw error
      });
    });
  }

  // resolve é™æ€æ–¹æ³•
  static resolve (parameter) {
    // å¦‚æœä¼ å…¥ MyPromise å°±ç›´æ¥è¿”å›
    if (parameter instanceof MyPromise) {
      return parameter;
    }

    // è½¬æˆå¸¸è§„æ–¹å¼
    return new MyPromise(resolve =>  {
      resolve(parameter);
    });
  }

  // reject é™æ€æ–¹æ³•
  static reject (reason) {
    return new MyPromise((resolve, reject) => {
      reject(reason);
    });
  }

  static all (promiseList) {
    return new MyPromise((resolve, reject) => {
      const result = [];
      const length = promiseList.length;
      let count = 0;

      if (length === 0) {
        return resolve(result);
      }

      promiseList.forEach((promise, index) => {
        MyPromise.resolve(promise).then((value) => {
          count++;
          result[index] = value;
          if (count === length) {
            resolve(result);
          }
        }, (reason) => {
          reject(reason);
        });
      });
    });

  }

  static allSettled = (promiseList) => {
    return new MyPromise((resolve) => {
      const length = promiseList.length;
      const result = [];
      let count = 0;

      if (length === 0) {
        return resolve(result);
      } else {
        for (let i = 0; i < length; i++) {
            const currentPromise = MyPromise.resolve(promiseList[i]);
            currentPromise.then((value) => {
              count++;
              result[i] = {
                status: 'fulfilled',
                value: value
              }
              if (count === length) {
                return resolve(result);
              }
            }, (reason) => {
              count++;
              result[i] = {
                status: 'rejected',
                reason: reason
              }
              if (count === length) {
                return resolve(result);
              }
            });
        }
      }
    });
  }

  static race (promiseList) {
    return new MyPromise((resolve, reject) => {
      const length = promiseList.length;

      if (length === 0) {
        return resolve();
      } else {
        for (let i = 0; i < length; i++) {
          MyPromise.resolve(promiseList[i]).then((value) => {
            return resolve(value);
          }, (reason) => {
            return reject(reason);
          });
        }
      }
    });
  }
}

function resolvePromise(promise, x, resolve, reject) {
  // å¦‚æœ promise å’Œ x æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œä»¥ TypeError ä¸ºæ®å› æ‹’ç»æ‰§è¡Œ promise
  // è¿™æ˜¯ä¸ºäº†é˜²æ­¢æ­»å¾ªç¯
  if (promise === x) {
    return reject(new TypeError('The promise and the return value are the same'));
  }

  if (typeof x === 'object' || typeof x === 'function') {
    // è¿™ä¸ªå‘æ˜¯è·‘æµ‹è¯•çš„æ—¶å€™å‘ç°çš„ï¼Œå¦‚æœxæ˜¯nullï¼Œåº”è¯¥ç›´æ¥resolve
    if (x === null) {
      return resolve(x);
    }

    let then;
    try {
      // æŠŠ x.then èµ‹å€¼ç»™ then 
      then = x.then;
    } catch (error) {
      // å¦‚æœå– x.then çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ e ï¼Œåˆ™ä»¥ e ä¸ºæ®å› æ‹’ç» promise
      return reject(error);
    }

    // å¦‚æœ then æ˜¯å‡½æ•°
    if (typeof then === 'function') {
      let called = false;
      // å°† x ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ this è°ƒç”¨ä¹‹
      // ä¼ é€’ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å«åš resolvePromise ï¼Œç¬¬äºŒä¸ªå‚æ•°å«åš rejectPromise
      // åå­—é‡åäº†ï¼Œæˆ‘ç›´æ¥ç”¨åŒ¿åå‡½æ•°äº†
      try {
        then.call(
          x,
          // å¦‚æœ resolvePromise ä»¥å€¼ y ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ [[Resolve]](promise, y)
          y => {
            // å¦‚æœ resolvePromise å’Œ rejectPromise å‡è¢«è°ƒç”¨ï¼Œ
            // æˆ–è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©ä¸‹çš„è°ƒç”¨
            // å®ç°è¿™æ¡éœ€è¦å‰é¢åŠ ä¸€ä¸ªå˜é‡called
            if (called) return;
            called = true;
            resolvePromise(promise, y, resolve, reject);
          },
          // å¦‚æœ rejectPromise ä»¥æ®å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ®å›  r æ‹’ç» promise
          r => {
            if (called) return;
            called = true;
            reject(r);
          });
      } catch (error) {
        // å¦‚æœè°ƒç”¨ then æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ eï¼š
        // å¦‚æœ resolvePromise æˆ– rejectPromise å·²ç»è¢«è°ƒç”¨ï¼Œåˆ™å¿½ç•¥ä¹‹
        if (called) return;

        // å¦åˆ™ä»¥ e ä¸ºæ®å› æ‹’ç» promise
        reject(error);
      }
    } else {
      // å¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise
      resolve(x);
    }
  } else {
    // å¦‚æœ x ä¸ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise
    resolve(x);
  }
}

MyPromise.deferred = function () {
  var result = {};
  result.promise = new MyPromise(function (resolve, reject) {
    result.resolve = resolve;
    result.reject = reject;
  });

  return result;
}


module.exports = MyPromise
```

### å®ç°promise.all

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­â­)

```js
functionÂ PromiseAll(promises){  
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)=>{  
Â Â Â Â Â Â Â Â if(!Array.isArray(promises)){  
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ TypeError("promisesÂ mustÂ beÂ anÂ array")  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â letÂ resultÂ =Â []Â   
Â Â Â Â Â Â Â Â letÂ countÂ =Â 0Â   
Â Â Â Â Â Â Â Â promises.forEach((promise,Â index)Â =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â promise.then((res)=>{  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result[index]Â =Â res  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â count++  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â countÂ ===Â promises.lengthÂ &&Â resolve(result)Â   
Â Â Â Â Â Â Â Â Â Â Â Â },Â (err)=>{  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â reject(err)  
Â Â Â Â Â Â Â Â Â Â Â Â })  
Â Â Â Â Â Â Â Â })  
Â Â Â Â })  
}
```

### å®ç° promise.finally

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­â­)

```js
Promise.prototype.finallyÂ =Â functionÂ (cb)Â {  
Â Â returnÂ this.then(functionÂ (value)Â {  
Â Â Â Â returnÂ Promise.resolve(cb()).then(functionÂ ()Â {  
Â Â Â Â Â Â returnÂ value  
Â Â Â Â })  
Â Â },Â functionÂ (err)Â {  
Â Â Â Â returnÂ Promise.resolve(cb()).then(functionÂ ()Â {  
Â Â Â Â Â Â throwÂ err  
Â Â Â Â })  
Â Â })  
}
```

### å®ç°promise.allSettled

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

```js
functionÂ allSettled(promises)Â {  
Â Â ifÂ (promises.lengthÂ ===Â 0)Â returnÂ Promise.resolve([])  
Â Â   
Â Â constÂ _promisesÂ =Â promises.map(  
Â Â Â Â itemÂ =>Â itemÂ instanceofÂ PromiseÂ ?Â itemÂ :Â Promise.resolve(item)  
Â Â Â Â )  
Â Â   
Â Â returnÂ newÂ Promise((resolve,Â reject)Â =>Â {  
Â Â Â Â constÂ resultÂ =Â []  
Â Â Â Â letÂ unSettledPromiseCountÂ =Â _promises.length  
Â Â Â Â   
Â Â Â Â _promises.forEach((promise,Â index)Â =>Â {  
Â Â Â Â Â Â promise.then((value)Â =>Â {  
Â Â Â Â Â Â Â Â result[index]Â =Â {  
Â Â Â Â Â Â Â Â Â Â status:Â 'fulfilled',  
Â Â Â Â Â Â Â Â Â Â value  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â Â unSettledPromiseCountÂ -=Â 1  
Â Â Â Â Â Â Â Â //Â resolveÂ afterÂ allÂ areÂ settled  
Â Â Â Â Â Â Â Â ifÂ (unSettledPromiseCountÂ ===Â 0)Â {  
Â Â Â Â Â Â Â Â Â Â resolve(result)  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â },Â (reason)Â =>Â {  
Â Â Â Â Â Â Â Â result[index]Â =Â {  
Â Â Â Â Â Â Â Â Â Â status:Â 'rejected',  
Â Â Â Â Â Â Â Â Â Â reason  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â Â unSettledPromiseCountÂ -=Â 1  
Â Â Â Â Â Â Â Â //Â resolveÂ afterÂ allÂ areÂ settled  
Â Â Â Â Â Â Â Â ifÂ (unSettledPromiseCountÂ ===Â 0)Â {  
Â Â Â Â Â Â Â Â Â Â resolve(result)  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â })  
Â Â Â Â })  
Â Â })  
}
```

### å®ç°promise.race

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
Promise.raceÂ =Â function(promiseArr)Â {  
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)Â =>Â {  
Â Â Â Â Â Â Â Â promiseArr.forEach(pÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Promise.resolve(p).then(valÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resolve(val)  
Â Â Â Â Â Â Â Â Â Â Â Â },Â errÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â rejecte(err)  
Â Â Â Â Â Â Â Â Â Â Â Â })  
Â Â Â Â Â Â Â Â })  
Â Â Â Â })  
}
```

### promise.any

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
Promise.anyÂ =Â function(promiseArr)Â {  
Â Â Â Â letÂ indexÂ =Â 0  
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)Â =>Â {  
Â Â Â Â Â Â Â Â ifÂ (promiseArr.lengthÂ ===Â 0)Â returnÂ   
Â Â Â Â Â Â Â Â promiseArr.forEach((p,Â i)Â =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Promise.resolve(p).then(valÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resolve(val)  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â Â Â Â Â Â },Â errÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â index++  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (indexÂ ===Â promiseArr.length)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â reject(newÂ AggregateError('AllÂ promisesÂ wereÂ rejected'))  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â Â Â Â Â })  
Â Â Â Â Â Â Â Â })  
Â Â Â Â })  
}
```

### resolve

```js
Promise.resolveÂ =Â function(value)Â {  
Â Â Â Â if(valueÂ instanceofÂ Promise){  
Â Â Â Â Â Â Â Â returnÂ value  
Â Â Â Â }  
Â Â Â Â returnÂ newÂ Promise(resolveÂ =>Â resolve(value))  
}
```

### reject

```js
Promise.rejectÂ =Â function(reason)Â {  
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)Â =>Â reject(reason))  
}
```


## ğŸ³ Arrayç¯‡

### æ•°ç»„å»é‡

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­â­)

#### ä½¿ç”¨åŒé‡Â `for`Â å’ŒÂ `splice`

```js
functionÂ unique(arr){Â Â Â Â Â Â Â Â Â Â Â Â   
Â Â Â Â for(varÂ i=0;Â i<arr.length;Â i++){  
Â Â Â Â Â Â Â Â for(varÂ j=i+1;Â j<arr.length;Â j++){  
Â Â Â Â Â Â Â Â Â Â Â Â if(arr[i]==arr[j]){Â Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â Â Â Â Â Â //ç¬¬ä¸€ä¸ªç­‰åŒäºç¬¬äºŒä¸ªï¼Œspliceæ–¹æ³•åˆ é™¤ç¬¬äºŒä¸ª  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â arr.splice(j,1);  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â åˆ é™¤åæ³¨æ„å›è°ƒj  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â j--;  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
returnÂ arr;  
}
```

#### ä½¿ç”¨Â `indexOf`Â æˆ–Â `includes`Â åŠ æ–°æ•°ç»„

```js
//ä½¿ç”¨indexof  
functionÂ unique(arr)Â {  
Â Â Â Â varÂ uniqueArrÂ =Â [];Â //Â æ–°æ•°ç»„  
Â Â Â Â forÂ (letÂ iÂ =Â 0;Â iÂ <Â arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â ifÂ (uniqueArr.indexOf(arr[i])Â ===Â -1)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â //indexofè¿”å›-1è¡¨ç¤ºåœ¨æ–°æ•°ç»„ä¸­ä¸å­˜åœ¨è¯¥å…ƒç´   
Â Â Â Â Â Â Â Â Â Â Â Â uniqueArr.push(arr[i])//æ˜¯æ–°æ•°ç»„é‡Œæ²¡æœ‰çš„å…ƒç´ å°±pushå…¥  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ uniqueArr;  
}  
//Â ä½¿ç”¨includes  
functionÂ unique(arr)Â {  
Â Â Â Â varÂ uniqueArrÂ =Â [];Â   
Â Â Â Â forÂ (letÂ iÂ =Â 0;Â iÂ <Â arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //includesÂ æ£€æµ‹æ•°ç»„æ˜¯å¦æœ‰æŸä¸ªå€¼  
Â Â Â Â Â Â Â Â ifÂ (!uniqueArr.includes(arr[i]))Â {  
Â Â Â Â Â Â Â Â Â Â Â Â uniqueArr.push(arr[i])//  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ uniqueArr;  
}
```

#### `sort`Â æ’åºåï¼Œä½¿ç”¨å¿«æ…¢æŒ‡é’ˆçš„æ€æƒ³

```js
functionÂ unique(arr)Â {  
Â Â Â Â arr.sort((a,Â b)Â =>Â aÂ -Â b);  
Â Â Â Â varÂ slowÂ =Â 1,  
Â Â Â Â Â Â Â Â fastÂ =Â 1;  
Â Â Â Â whileÂ (fastÂ <Â arr.length)Â {  
Â Â Â Â Â Â Â Â ifÂ (arr[fast]Â !=Â arr[fastÂ -Â 1])Â {  
Â Â Â Â Â Â Â Â Â Â Â Â arr[slowÂ ++]Â =Â arr[fast];  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â ++Â fast;  
Â Â Â Â }  
Â Â Â Â arr.lengthÂ =Â slow;  
Â Â Â Â returnÂ arr;  
}
```

`sort`Â æ–¹æ³•ç”¨äºä»å°åˆ°å¤§æ’åº(è¿”å›ä¸€ä¸ªæ–°æ•°ç»„)ï¼Œå…¶å‚æ•°ä¸­ä¸å¸¦ä»¥ä¸Šå›è°ƒå‡½æ•°å°±ä¼šåœ¨ä¸¤ä½æ•°åŠä»¥ä¸Šæ—¶å‡ºç°æ’åºé”™è¯¯(å¦‚æœçœç•¥ï¼Œå…ƒç´ æŒ‰ç…§è½¬æ¢ä¸ºçš„å­—ç¬¦ä¸²çš„å„ä¸ªå­—ç¬¦çš„Â `Unicode`Â ä½ç‚¹è¿›è¡Œæ’åºã€‚ä¸¤ä½æ•°ä¼šå˜ä¸ºé•¿åº¦ä¸ºäºŒçš„å­—ç¬¦ä¸²æ¥è®¡ç®—)ã€‚

#### `ES6`Â æä¾›çš„Â `Set`Â å»é‡

```js
functionÂ unique(arr)Â {  
Â Â Â Â constÂ resultÂ =Â newÂ Set(arr);  
Â Â Â Â returnÂ [...result];  
Â Â Â Â //ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å°†Setæ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„  
}
```

`Set`Â ä¸­çš„å…ƒç´ åªä¼šå‡ºç°ä¸€æ¬¡ï¼Œå³Â `Set`Â ä¸­çš„å…ƒç´ æ˜¯å”¯ä¸€çš„ã€‚

#### ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ æ˜¯å¦å‡ºç°(`ES6`Â æä¾›çš„Â `map`)

```js
functionÂ unique(arr)Â {  
Â Â Â Â letÂ mapÂ =Â newÂ Map();  
Â Â Â Â letÂ uniqueArrÂ =Â newÂ Array();Â Â //Â æ•°ç»„ç”¨äºè¿”å›ç»“æœ  
Â Â Â Â forÂ (letÂ iÂ =Â 0;Â iÂ <Â arr.length;Â i++)Â {  
Â Â Â Â Â Â if(map.has(arr[i]))Â {Â Â //Â å¦‚æœæœ‰è¯¥keyå€¼  
Â Â Â Â Â Â Â Â map.set(arr[i],Â true);Â   
Â Â Â Â Â Â }Â elseÂ {Â   
Â Â Â Â Â Â Â Â map.set(arr[i],Â false);Â Â Â //Â å¦‚æœæ²¡æœ‰è¯¥keyå€¼  
Â Â Â Â Â Â Â Â uniqueArr.push(arr[i]);  
Â Â Â Â Â Â }  
Â Â Â Â }Â   
Â Â Â Â returnÂ uniqueArrÂ ;  
}
```

`   map`Â å¯¹è±¡ä¿å­˜é”®å€¼å¯¹ï¼Œä¸å¯¹è±¡ç±»ä¼¼ã€‚ä½†Â `map`Â çš„é”®å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œå¯¹è±¡çš„é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚

å¦‚æœæ•°ç»„ä¸­åªæœ‰æ•°å­—ä¹Ÿå¯ä»¥ä½¿ç”¨æ™®é€šå¯¹è±¡ä½œä¸ºå“ˆå¸Œè¡¨ã€‚

#### `filter`Â é…åˆÂ `indexOf`

```js
functionÂ unique(arr)Â {  
Â Â Â Â returnÂ arr.filter(functionÂ (item,Â index,Â arr)Â {  
Â Â Â Â Â Â Â Â //å½“å‰å…ƒç´ ï¼Œåœ¨åŸå§‹æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªç´¢å¼•==å½“å‰ç´¢å¼•å€¼ï¼Œå¦åˆ™è¿”å›å½“å‰å…ƒç´   
Â Â Â Â Â Â Â Â //ä¸æ˜¯é‚£ä¹ˆå°±è¯æ˜æ˜¯é‡å¤é¡¹ï¼Œå°±èˆå¼ƒ  
Â Â Â Â Â Â Â Â returnÂ arr.indexOf(item)Â ===Â index;  
Â Â Â Â })  
}
```

```js
// å¦‚ä½•æ£€æŸ¥ä¹‹å‰å‡ºç°è¿‡åŒæ ·æ•°å­—

constÂ arrÂ =Â [1,1,2,1,3]  
arr.indexOf(arr[0])Â ===Â 0Â //Â 1Â çš„ç¬¬ä¸€æ¬¡å‡ºç°  
arr.indexOf(arr[1])Â !==Â 1Â //Â è¯´æ˜å‰é¢æ›¾ç»å‡ºç°è¿‡1
```

#### `reduce`Â é…åˆÂ `includes`

```js
functionÂ unique(arr){  
Â Â Â Â letÂ uniqueArrÂ =Â arr.reduce((acc,cur)=>{  
Â Â Â Â Â Â Â Â if(!acc.includes(cur)){  
Â Â Â Â Â Â Â Â Â Â Â Â acc.push(cur);  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â returnÂ acc;  
Â Â Â Â },[])Â //Â []ä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„åˆå§‹å€¼  
Â Â Â Â returnÂ uniqueArr  
}
```

### æ•°ç»„æ‰å¹³åŒ–

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

#### ç”¨Â `reduce`Â å®ç°Â `flat`Â å‡½æ•°

```js
const arr = [1, 2, 3, 4, [1, 2, 3, [1, 2, 3, [1, 2, 3]]], 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }]

// é¦–å…ˆä½¿ç”¨ reduce å±•å¼€ä¸€å±‚
arr.reduce((pre, cur) => pre.concat(cur), []);
// [1, 2, 3, 4, 1, 2, 3, [1, 2, 3, [1, 2, 3]], 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }];

// ç”¨ reduce å±•å¼€ä¸€å±‚ + é€’å½’
const flat = arr => {
  return arr.reduce((pre, cur) => {
    return pre.concat(Array.isArray(cur) ? flat(cur) : cur);
  }, []);
};
// [1, 2, 3, 4, 1, 2, 3, 1, 2, 3, 1, 2, 3, 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }];

```

#### ä½¿ç”¨æ ˆçš„æ€æƒ³å®ç°Â `flat`Â å‡½æ•°

```js
// æ ˆæ€æƒ³
function flat(arr) {
  const result = []; 
  const stack = [].concat(arr);  // å°†æ•°ç»„å…ƒç´ æ‹·è´è‡³æ ˆï¼Œç›´æ¥èµ‹å€¼ä¼šæ”¹å˜åŸæ•°ç»„
  //å¦‚æœæ ˆä¸ä¸ºç©ºï¼Œåˆ™å¾ªç¯éå†
  while (stack.length !== 0) {
    const val = stack.pop(); 
    if (Array.isArray(val)) {
      stack.push(...val); //å¦‚æœæ˜¯æ•°ç»„å†æ¬¡å…¥æ ˆï¼Œå¹¶ä¸”å±•å¼€äº†ä¸€å±‚
    } else {
      result.unshift(val); //å¦‚æœä¸æ˜¯æ•°ç»„å°±å°†å…¶å–å‡ºæ¥æ”¾å…¥ç»“æœæ•°ç»„ä¸­
    }
  }
  return result;
}
const arr = [1, 2, 3, 4, [1, 2, 3, [1, 2, 3, [1, 2, 3]]], 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }]
flat(arr)
// [1, 2, 3, 4, 1, 2, 3, 1, 2, 3, 1, 2, 3, 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }];
```

#### ä½¿ç”¨Â `Generator`Â å®ç°Â `flat`Â å‡½æ•°

```js
function* flat(arr, num) {
  if (num === undefined) num = 1;
  for (const item of arr) {
    if (Array.isArray(item) && num > 0) {   // num > 0
      yield* flat(item, num - 1);
    } else {
      yield item;
    }
  }
}
const arr = [1, 2, 3, 4, [1, 2, 3, [1, 2, 3, [1, 2, 3]]], 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }]
// è°ƒç”¨ Generator å‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ã€‚
// ä¹Ÿå°±æ˜¯éå†å™¨å¯¹è±¡ï¼ˆIterator Objectï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬è¦ç”¨ä¸€æ¬¡æ‰©å±•è¿ç®—ç¬¦å¾—åˆ°ç»“æœ
[...flat(arr, Infinity)]    
// [1, 2, 3, 4, 1, 2, 3, 1, 2, 3, 1, 2, 3, 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }];

```

#### å®ç°åœ¨åŸå‹é“¾ä¸Šé‡å†™Â `flat`Â å‡½æ•°

```js
Array.prototype.fakeFlat = function(num = 1) {
  if (!Number(num) || Number(num) < 0) {
    return this;
  }
  let arr = this.concat();    // è·å¾—è°ƒç”¨ fakeFlat å‡½æ•°çš„æ•°ç»„
  while (num > 0) {           
    if (arr.some(x => Array.isArray(x))) {
      arr = [].concat.apply([], arr);	// æ•°ç»„ä¸­è¿˜æœ‰æ•°ç»„å…ƒç´ çš„è¯å¹¶ä¸” num > 0ï¼Œç»§ç»­å±•å¼€ä¸€å±‚æ•°ç»„ 
    } else {
      break; // æ•°ç»„ä¸­æ²¡æœ‰æ•°ç»„å…ƒç´ å¹¶ä¸”ä¸ç®¡ num æ˜¯å¦ä¾æ—§å¤§äº 0ï¼Œåœæ­¢å¾ªç¯ã€‚
    }
    num--;
  }
  return arr;
};
const arr = [1, 2, 3, 4, [1, 2, 3, [1, 2, 3, [1, 2, 3]]], 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }]
arr.fakeFlat(Infinity)
// [1, 2, 3, 4, 1, 2, 3, 1, 2, 3, 1, 2, 3, 5, "string", { name: "å¼¹é“è›‹åŒå­¦" }];
```

### forEach

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
Array.prototype.myForEachÂ =Â functionÂ (callbackFn)Â {  
Â Â Â Â //Â åˆ¤æ–­thisæ˜¯å¦åˆæ³•  
Â Â Â Â ifÂ (thisÂ ===Â nullÂ ||Â thisÂ ===Â undefined)Â {  
Â Â Â Â Â Â Â Â throwÂ newÂ TypeError("CannotÂ readÂ propertyÂ 'myForEach'Â ofÂ null");  
Â Â Â Â }  
Â Â Â Â //Â åˆ¤æ–­callbackFnæ˜¯å¦åˆæ³•  
Â Â Â Â ifÂ (Object.prototype.toString.call(callbackFn)Â !==Â "[objectÂ Function]")Â {  
Â Â Â Â Â Â Â Â throwÂ newÂ TypeError(callbackFnÂ +Â 'Â isÂ notÂ aÂ function')  
Â Â Â Â }  
Â Â Â Â //Â å–åˆ°æ‰§è¡Œæ–¹æ³•çš„æ•°ç»„å¯¹è±¡å’Œä¼ å…¥çš„thiså¯¹è±¡  
Â Â Â Â varÂ _arrÂ =Â this,Â thisArgÂ =Â arguments[1]Â ||Â window;  
Â Â Â Â forÂ (varÂ iÂ =Â 0;Â iÂ <Â _arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //Â æ‰§è¡Œå›è°ƒå‡½æ•°  
Â Â Â Â Â Â Â Â callbackFn.call(thisArg,Â _arr[i],Â i,Â _arr);  
Â Â Â Â }  
}
```

### reduce [[reduce]]

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
Array.prototype.myReduceÂ =Â function(callbackFn)Â {  
Â Â Â Â varÂ _arrÂ =Â this,Â accumulatorÂ =Â arguments[1];  
Â Â Â Â varÂ iÂ =Â 0;  
Â Â Â Â //Â åˆ¤æ–­æ˜¯å¦ä¼ å…¥åˆå§‹å€¼  
Â Â Â Â ifÂ (accumulatorÂ ===Â undefined)Â {  
Â Â Â Â Â Â Â Â //Â æ²¡æœ‰åˆå§‹å€¼çš„ç©ºæ•°ç»„è°ƒç”¨reduceä¼šæŠ¥é”™  
Â Â Â Â Â Â Â Â ifÂ (_arr.lengthÂ ===Â 0)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ Error('initValÂ andÂ Array.length>0Â needÂ one')  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â //Â åˆå§‹å€¼èµ‹å€¼ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´   
Â Â Â Â Â Â Â Â accumulatorÂ =Â _arr[i];  
Â Â Â Â Â Â Â Â i++;  
Â Â Â Â }  
Â Â Â Â forÂ (;Â i<_arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //Â è®¡ç®—ç»“æœèµ‹å€¼ç»™åˆå§‹å€¼  
Â Â Â Â Â Â Â Â accumulatorÂ =Â callbackFn(accumulator,Â Â _arr[i],Â i,Â _arr)  
Â Â Â Â }  
Â Â Â Â returnÂ accumulator;  
}
```

### map

```js
Array.prototype.myMapÂ =Â function(callbackFn)Â {  
Â Â Â Â varÂ _arrÂ =Â this,Â thisArgÂ =Â arguments[1]Â ||Â window,Â resÂ =Â [];  
Â Â Â Â forÂ (varÂ iÂ =Â 0;Â i<_arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //Â å­˜å‚¨è¿ç®—ç»“æœ  
Â Â Â Â Â Â Â Â res.push(callbackFn.call(thisArg,Â _arr[i],Â i,Â _arr));  
Â Â Â Â }  
Â Â Â Â returnÂ res;  
}
```

### every

```js
Array.prototype.myEveryÂ =Â function(callbackFn)Â {  
Â Â Â Â varÂ _arrÂ =Â this,Â thisArgÂ =Â arguments[1]Â ||Â window;  
Â Â Â Â //Â å¼€å§‹æ ‡è¯†å€¼ä¸ºtrue  
Â Â Â Â //Â é‡åˆ°å›è°ƒè¿”å›falseï¼Œç›´æ¥è¿”å›false  
Â Â Â Â //Â å¦‚æœå¾ªç¯æ‰§è¡Œå®Œæ¯•ï¼Œæ„å‘³ç€æ‰€æœ‰å›è°ƒè¿”å›å€¼ä¸ºtrueï¼Œæœ€ç»ˆç»“æœä¸ºtrue  
Â Â Â Â varÂ flagÂ =Â true;  
Â Â Â Â forÂ (varÂ iÂ =Â 0;Â i<_arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //Â å›è°ƒå‡½æ•°æ‰§è¡Œä¸ºfalseï¼Œå‡½æ•°ä¸­æ–­  
Â Â Â Â Â Â Â Â ifÂ (!callbackFn.call(thisArg,Â _arr[i],Â i,Â _arr))Â {  
Â Â Â Â Â Â Â Â Â Â Â Â returnÂ false;  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ flag;  
}
```

### some

```js
Array.prototype.mySomeÂ =Â function(callbackFn)Â {  
Â Â Â Â varÂ _arrÂ =Â this,Â thisArgÂ =Â arguments[1]Â ||Â window;  
Â Â Â Â //Â å¼€å§‹æ ‡è¯†å€¼ä¸ºfalse  
Â Â Â Â //Â é‡åˆ°å›è°ƒè¿”å›trueï¼Œç›´æ¥è¿”å›true  
Â Â Â Â //Â å¦‚æœå¾ªç¯æ‰§è¡Œå®Œæ¯•ï¼Œæ„å‘³ç€æ‰€æœ‰å›è°ƒè¿”å›å€¼ä¸ºfalseï¼Œæœ€ç»ˆç»“æœä¸ºfalse  
Â Â Â Â varÂ flagÂ =Â false;  
Â Â Â Â forÂ (varÂ iÂ =Â 0;Â i<_arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //Â å›è°ƒå‡½æ•°æ‰§è¡Œä¸ºfalseï¼Œå‡½æ•°ä¸­æ–­  
Â Â Â Â Â Â Â Â ifÂ (callbackFn.call(thisArg,Â _arr[i],Â i,Â _arr))Â {  
Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true;  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ flag;  
}
```

### find/findIndex

```js
Array.prototype.myFindÂ =Â function(callbackFn)Â {  
Â Â Â Â varÂ _arrÂ =Â this,Â thisArgÂ =Â arguments[1]Â ||Â window;  
Â Â Â Â //Â é‡åˆ°å›è°ƒè¿”å›trueï¼Œç›´æ¥è¿”å›è¯¥æ•°ç»„å…ƒç´   
Â Â Â Â //Â å¦‚æœå¾ªç¯æ‰§è¡Œå®Œæ¯•ï¼Œæ„å‘³ç€æ‰€æœ‰å›è°ƒè¿”å›å€¼ä¸ºfalseï¼Œæœ€ç»ˆç»“æœä¸ºundefined  
Â Â Â Â forÂ (varÂ iÂ =Â 0;Â i<_arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â //Â å›è°ƒå‡½æ•°æ‰§è¡Œä¸ºfalseï¼Œå‡½æ•°ä¸­æ–­  
Â Â Â Â Â Â Â Â ifÂ (callbackFn.call(thisArg,Â _arr[i],Â i,Â _arr))Â {  
Â Â Â Â Â Â Â Â Â Â Â Â returnÂ _arr[i];  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ undefined;  
}
```

### indexOf

```js
functionÂ indexOf(findVal,Â beginIndexÂ =Â 0)Â {  
Â Â Â Â ifÂ (this.lengthÂ <Â 1Â ||Â beginIndexÂ >Â findVal.length)Â {  
Â Â Â Â Â Â Â Â returnÂ -1;  
Â Â Â Â }  
Â Â Â Â ifÂ (!findVal)Â {  
Â Â Â Â Â Â Â Â returnÂ 0;  
Â Â Â Â }  
Â Â Â Â beginIndexÂ =Â beginIndexÂ <=Â 0Â ?Â 0Â :Â beginIndex;  
Â Â Â Â forÂ (letÂ iÂ =Â beginIndex;Â iÂ <Â this.length;Â i++)Â {  
Â Â Â Â Â Â Â Â ifÂ (this[i]Â ==Â findVal)Â returnÂ i;  
Â Â Â Â }  
Â Â Â Â returnÂ -1;  
}
```

## å®ç°sort [èƒ½ä¸èƒ½å®ç°æ•°ç»„sortæ–¹æ³•](https://juejin.cn/post/6844903986479251464#heading-33)

```js
const sort = (arr, comparefn) => {
  let array = Object(arr);
  let length = array.length >>> 0;
  return InnerArraySort(array, length, comparefn);
}

const InnerArraySort = (array, length, comparefn) => {
  // æ¯”è¾ƒå‡½æ•°æœªä¼ å…¥
  if (Object.prototype.toString.call(comparefn) !== "[object Function]") {
    comparefn = function (x, y) {
      if (x === y) return 0;
      x = x.toString();
      y = y.toString();
      if (x == y) return 0;
      else return x < y ? -1 : 1;
    };
  }
  const insertSort = (arr, start = 0, end) => {
    end = end || arr.length;
    for (let i = start; i < end; i++) {
      let e = arr[i];
      let j;
      for (j = i; j > start && comparefn(arr[j - 1], e) > 0; j--)
        arr[j] = arr[j - 1];
      arr[j] = e;
    }
    return;
  }
  const getThirdIndex = (a, from, to) => {
    let tmpArr = [];
    // é€’å¢é‡ï¼Œ200~215 ä¹‹é—´ï¼Œå› ä¸ºä»»ä½•æ­£æ•°å’Œ15åšä¸æ“ä½œï¼Œä¸ä¼šè¶…è¿‡15ï¼Œå½“ç„¶æ˜¯å¤§äº0çš„
    let increment = 200 + ((to - from) & 15);
    let j = 0;
    from += 1;
    to -= 1;
    for (let i = from; i < to; i += increment) {
      tmpArr[j] = [i, a[i]];
      j++;
    }
    // æŠŠä¸´æ—¶æ•°ç»„æ’åºï¼Œå–ä¸­é—´çš„å€¼ï¼Œç¡®ä¿å“¨å…µçš„å€¼æ¥è¿‘å¹³å‡ä½ç½®
    tmpArr.sort(function (a, b) {
      return comparefn(a[1], b[1]);
    });
    let thirdIndex = tmpArr[tmpArr.length >> 1][0];
    return thirdIndex;
  };

  const _sort = (a, b, c) => {
    let arr = [];
    arr.push(a, b, c);
    insertSort(arr, 0, 3);
    return arr;
  }

  const quickSort = (a, from, to) => {
    //å“¨å…µä½ç½®
    let thirdIndex = 0;
    while (true) {
      if (to - from <= 10) {
        insertSort(a, from, to);
        return;
      }
      if (to - from > 1000) {
        thirdIndex = getThirdIndex(a, from, to);
      } else {
        // å°äº1000 ç›´æ¥å–ä¸­ç‚¹
        thirdIndex = from + ((to - from) >> 2);
      }
      let tmpArr = _sort(a[from], a[thirdIndex], a[to - 1]);
      a[from] = tmpArr[0]; a[thirdIndex] = tmpArr[1]; a[to - 1] = tmpArr[2];
      // ç°åœ¨æ­£å¼æŠŠ thirdIndex ä½œä¸ºå“¨å…µ
      let pivot = a[thirdIndex];
      [a[from], a[thirdIndex]] = [a[thirdIndex], a[from]];
      // æ­£å¼è¿›å…¥å¿«æ’
      let lowEnd = from + 1;
      let highStart = to - 1;
      a[thirdIndex] = a[lowEnd];
      a[lowEnd] = pivot;
      // [lowEnd, i)çš„å…ƒç´ æ˜¯å’Œpivotç›¸ç­‰çš„
      // [i, highStart) çš„å…ƒç´ æ˜¯éœ€è¦å¤„ç†çš„
      for (let i = lowEnd + 1; i < highStart; i++) {
        let element = a[i];
        let order = comparefn(element, pivot);
        if (order < 0) {
          a[i] = a[lowEnd];
          a[lowEnd] = element;
          lowEnd++;
        } else if (order > 0) {
          do{
            highStart--;
            if (highStart === i) break;
            order = comparefn(a[highStart], pivot);
          }while (order > 0) ;
          // ç°åœ¨ a[highStart] <= pivot
          // a[i] > pivot
          // ä¸¤è€…äº¤æ¢
          a[i] = a[highStart];
          a[highStart] = element;
          if (order < 0) {
            // a[i] å’Œ a[lowEnd] äº¤æ¢
            element = a[i];
            a[i] = a[lowEnd];
            a[lowEnd] = element;
            lowEnd++;
          }
        }
      }
      // æ°¸è¿œåˆ‡åˆ†å¤§åŒºé—´
      if (lowEnd - from > to - highStart) {
        // å•ç‹¬å¤„ç†å°åŒºé—´
        quickSort(a, highStart, to);
        // ç»§ç»­åˆ‡åˆ†lowEnd ~ from è¿™ä¸ªåŒºé—´
        to = lowEnd;
      } else if (lowEnd - from <= to - highStart) {
        quickSort(a, from, lowEnd);
        from = highStart;
      }
    }
  }
  quickSort(array, 0, length);
}

```

## ğŸŒŠ é˜²æŠ–èŠ‚æµ

### å®ç°é˜²æŠ–å‡½æ•°debounce

```js
functionÂ debounce(func,Â wait,Â immediate)Â {  
  
Â Â Â Â varÂ timeout,Â result;  
  
Â Â Â Â varÂ debouncedÂ =Â functionÂ ()Â {  
Â Â Â Â Â Â Â Â varÂ contextÂ =Â this;  
Â Â Â Â Â Â Â Â varÂ argsÂ =Â arguments;  
  
Â Â Â Â Â Â Â Â ifÂ (timeout)Â clearTimeout(timeout);  
Â Â Â Â Â Â Â Â ifÂ (immediate)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â //Â å¦‚æœå·²ç»æ‰§è¡Œè¿‡ï¼Œä¸å†æ‰§è¡Œ  
Â Â Â Â Â Â Â Â Â Â Â Â varÂ callNowÂ =Â !timeout;  
Â Â Â Â Â Â Â Â Â Â Â Â timeoutÂ =Â setTimeout(function(){  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â timeoutÂ =Â null;  
Â Â Â Â Â Â Â Â Â Â Â Â },Â wait)  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (callNow)Â resultÂ =Â func.apply(context,Â args)  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â elseÂ {  
Â Â Â Â Â Â Â Â Â Â Â Â timeoutÂ =Â setTimeout(function(){  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â func.apply(context,Â args)  
Â Â Â Â Â Â Â Â Â Â Â Â },Â wait);  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â returnÂ result;  
Â Â Â Â };  
  
Â Â Â Â debounced.cancelÂ =Â function()Â {  
Â Â Â Â Â Â Â Â clearTimeout(timeout);  
Â Â Â Â Â Â Â Â timeoutÂ =Â null;  
Â Â Â Â };  
  
Â Â Â Â returnÂ debounced;  
}
```

### å®ç°èŠ‚æµå‡½æ•°throttle

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­â­)

```js
//Â ç¬¬å››ç‰ˆ  
functionÂ throttle(func,Â wait,Â options)Â {  
Â Â Â Â varÂ timeout,Â context,Â args,Â result;  
Â Â Â Â varÂ previousÂ =Â 0;  
Â Â Â Â ifÂ (!options)Â optionsÂ =Â {};  
  
Â Â Â Â varÂ laterÂ =Â function()Â {  
Â Â Â Â Â Â Â Â previousÂ =Â options.leadingÂ ===Â falseÂ ?Â 0Â :Â newÂ Date().getTime();  
Â Â Â Â Â Â Â Â timeoutÂ =Â null;  
Â Â Â Â Â Â Â Â func.apply(context,Â args);  
Â Â Â Â Â Â Â Â ifÂ (!timeout)Â contextÂ =Â argsÂ =Â null;  
Â Â Â Â };  
  
Â Â Â Â varÂ throttledÂ =Â function()Â {  
Â Â Â Â Â Â Â Â varÂ nowÂ =Â newÂ Date().getTime();  
Â Â Â Â Â Â Â Â ifÂ (!previousÂ &&Â options.leadingÂ ===Â false)Â previousÂ =Â now;  
Â Â Â Â Â Â Â Â varÂ remainingÂ =Â waitÂ -Â (nowÂ -Â previous);  
Â Â Â Â Â Â Â Â contextÂ =Â this;  
Â Â Â Â Â Â Â Â argsÂ =Â arguments;  
Â Â Â Â Â Â Â Â ifÂ (remainingÂ <=Â 0Â ||Â remainingÂ >Â wait)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (timeout)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â clearTimeout(timeout);  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â timeoutÂ =Â null;  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â Â Â Â Â previousÂ =Â now;  
Â Â Â Â Â Â Â Â Â Â Â Â func.apply(context,Â args);  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!timeout)Â contextÂ =Â argsÂ =Â null;  
Â Â Â Â Â Â Â Â }Â elseÂ ifÂ (!timeoutÂ &&Â options.trailingÂ !==Â false)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â timeoutÂ =Â setTimeout(later,Â remaining);  
Â Â Â Â Â Â Â Â }  
Â Â Â Â };  
Â Â Â Â returnÂ throttled;  
}
```


## â›² Objectç¯‡

### èƒ½ä¸èƒ½å†™ä¸€ä¸ªå®Œæ•´çš„æ·±æ‹·è´[æ–‡ç« ](https://juejin.cn/post/6844903986479251464#heading-56)

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­â­)

```js
constÂ getTypeÂ =Â objÂ =>Â Object.prototype.toString.call(obj);  
  
constÂ isObjectÂ =Â (target)Â =>Â (typeofÂ targetÂ ===Â 'object'Â ||Â typeofÂ targetÂ ===Â 'function')Â &&Â targetÂ !==Â null;  
  
constÂ canTraverseÂ =Â {  
Â Â '[objectÂ Map]':Â true,  
Â Â '[objectÂ Set]':Â true,  
Â Â '[objectÂ Array]':Â true,  
Â Â '[objectÂ Object]':Â true,  
Â Â '[objectÂ Arguments]':Â true,  
};  
constÂ mapTagÂ =Â '[objectÂ Map]';  
constÂ setTagÂ =Â '[objectÂ Set]';  
constÂ boolTagÂ =Â '[objectÂ Boolean]';  
constÂ numberTagÂ =Â '[objectÂ Number]';  
constÂ stringTagÂ =Â '[objectÂ String]';  
constÂ symbolTagÂ =Â '[objectÂ Symbol]';  
constÂ dateTagÂ =Â '[objectÂ Date]';  
constÂ errorTagÂ =Â '[objectÂ Error]';  
constÂ regexpTagÂ =Â '[objectÂ RegExp]';  
constÂ funcTagÂ =Â '[objectÂ Function]';  
  
constÂ handleRegExpÂ =Â (target)Â =>Â {  
Â Â constÂ {Â source,Â flagsÂ }Â =Â target;  
Â Â returnÂ newÂ target.constructor(source,Â flags);  
}  
  
constÂ handleFuncÂ =Â (func)Â =>Â {  
Â Â //Â ç®­å¤´å‡½æ•°ç›´æ¥è¿”å›è‡ªèº«  
Â Â if(!func.prototype)Â returnÂ func;  
Â Â constÂ bodyRegÂ =Â /(?<={)(.|\n)+(?=})/m;  
Â Â constÂ paramRegÂ =Â /(?<=().+(?=)\s+{)/;  
Â Â constÂ funcStringÂ =Â func.toString();  
Â Â //Â åˆ†åˆ«åŒ¹é…Â å‡½æ•°å‚æ•°Â å’ŒÂ å‡½æ•°ä½“  
Â Â constÂ paramÂ =Â paramReg.exec(funcString);  
Â Â constÂ bodyÂ =Â bodyReg.exec(funcString);  
Â Â if(!body)Â returnÂ null;  
Â Â ifÂ (param)Â {  
Â Â Â Â constÂ paramArrÂ =Â param[0].split(',');  
Â Â Â Â returnÂ newÂ Function(...paramArr,Â body[0]);  
Â Â }Â elseÂ {  
Â Â Â Â returnÂ newÂ Function(body[0]);  
Â Â }  
}  
  
constÂ handleNotTraverseÂ =Â (target,Â tag)Â =>Â {  
Â Â constÂ CtorÂ =Â target.constructor;  
Â Â switch(tag)Â {  
Â Â Â Â caseÂ boolTag:  
Â Â Â Â Â Â returnÂ newÂ Object(Boolean.prototype.valueOf.call(target));  
Â Â Â Â caseÂ numberTag:  
Â Â Â Â Â Â returnÂ newÂ Object(Number.prototype.valueOf.call(target));  
Â Â Â Â caseÂ stringTag:  
Â Â Â Â Â Â returnÂ newÂ Object(String.prototype.valueOf.call(target));  
Â Â Â Â caseÂ symbolTag:  
Â Â Â Â Â Â returnÂ newÂ Object(Symbol.prototype.valueOf.call(target));  
Â Â Â Â caseÂ errorTag:Â   
Â Â Â Â caseÂ dateTag:  
Â Â Â Â Â Â returnÂ newÂ Ctor(target);  
Â Â Â Â caseÂ regexpTag:  
Â Â Â Â Â Â returnÂ handleRegExp(target);  
Â Â Â Â caseÂ funcTag:  
Â Â Â Â Â Â returnÂ handleFunc(target);  
Â Â Â Â default:  
Â Â Â Â Â Â returnÂ newÂ Ctor(target);  
Â Â }  
}  
  
constÂ deepCloneÂ =Â (target,Â mapÂ =Â newÂ WeakMap())Â =>Â {  
Â Â if(!isObject(target))Â   
Â Â Â Â returnÂ target;  
Â Â letÂ typeÂ =Â getType(target);  
Â Â letÂ cloneTarget;  
Â Â if(!canTraverse[type])Â {  
Â Â Â Â //Â å¤„ç†ä¸èƒ½éå†çš„å¯¹è±¡  
Â Â Â Â returnÂ handleNotTraverse(target,Â type);  
Â Â }elseÂ {  
Â Â Â Â //Â è¿™æ³¢æ“ä½œç›¸å½“å…³é”®ï¼Œå¯ä»¥ä¿è¯å¯¹è±¡çš„åŸå‹ä¸ä¸¢å¤±ï¼  
Â Â Â Â letÂ ctorÂ =Â target.constructor;  
Â Â Â Â cloneTargetÂ =Â newÂ ctor();  
Â Â }  
  
Â Â if(map.get(target))Â   
Â Â Â Â returnÂ target;  
Â Â map.set(target,Â true);  
  
Â Â if(typeÂ ===Â mapTag)Â {  
Â Â Â Â //å¤„ç†Map  
Â Â Â Â target.forEach((item,Â key)Â =>Â {  
Â Â Â Â Â Â cloneTarget.set(deepClone(key,Â map),Â deepClone(item,Â map));  
Â Â Â Â })  
Â Â }  
Â Â   
Â Â if(typeÂ ===Â setTag)Â {  
Â Â Â Â //å¤„ç†Set  
Â Â Â Â target.forEach(itemÂ =>Â {  
Â Â Â Â Â Â cloneTarget.add(deepClone(item,Â map));  
Â Â Â Â })  
Â Â }  
  
Â Â //Â å¤„ç†æ•°ç»„å’Œå¯¹è±¡  
Â Â forÂ (letÂ propÂ inÂ target)Â {  
Â Â Â Â ifÂ (target.hasOwnProperty(prop))Â {  
Â Â Â Â Â Â Â Â cloneTarget[prop]Â =Â deepClone(target[prop],Â map);  
Â Â Â Â }  
Â Â }  
Â Â returnÂ cloneTarget;  
}
```

### å®ç°new

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

```js
functionÂ createObject(Con)Â {  
Â Â Â Â //Â åˆ›å»ºæ–°å¯¹è±¡obj  
Â Â Â Â //Â varÂ objÂ =Â {};ä¹Ÿå¯ä»¥  
Â Â Â Â varÂ objÂ =Â Object.create(null);  
  
Â Â Â Â //Â å°†obj.__proto__Â ->Â æ„é€ å‡½æ•°åŸå‹  
Â Â Â Â //Â (ä¸æ¨è)obj.__proto__Â =Â Con.prototype  
Â Â Â Â Object.setPrototypeOf(obj,Â Con.prototype);  
  
Â Â Â Â //Â æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå¹¶æ¥å—æ„é€ å‡½æ•°è¿”å›å€¼  
Â Â Â Â constÂ retÂ =Â Con.apply(obj,Â [].slice.call(arguments,Â 1));  
  
Â Â Â Â //Â è‹¥æ„é€ å‡½æ•°è¿”å›å€¼ä¸ºå¯¹è±¡ï¼Œç›´æ¥è¿”å›è¯¥å¯¹è±¡  
Â Â Â Â //Â å¦åˆ™è¿”å›obj  
Â Â Â Â returnÂ typeof(ret)Â ===Â 'object'Â ?Â ret:Â obj;  
}
```

### ç»§æ‰¿[JavaScriptæ·±å…¥ä¹‹ç»§æ‰¿çš„å¤šç§æ–¹å¼å’Œä¼˜ç¼ºç‚¹](https://juejin.cn/post/6844903477819211784)

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

#### åŸå‹é“¾ç»§æ‰¿

#### å€Ÿç”¨æ„é€ å‡½æ•°(ç»å…¸ç»§æ‰¿)

```js
function Parent () {
    this.names = ['kevin', 'daisy'];
}

function Child () {
    Parent.call(this);
}

var child1 = new Child();

child1.names.push('yayu');

console.log(child1.names); // ["kevin", "daisy", "yayu"]

var child2 = new Child();

console.log(child2.names); // ["kevin", "daisy"]

```

#### ç»„åˆç»§æ‰¿

```js
function Parent (name) {
    this.name = name;
    this.colors = ['red', 'blue', 'green'];
}

Parent.prototype.getName = function () {
    console.log(this.name)
}

function Child (name, age) {

    Parent.call(this, name);

    this.age = age;

}

Child.prototype = new Parent();

var child1 = new Child('kevin', '18');

child1.colors.push('black');

console.log(child1.name); // kevin
console.log(child1.age); // 18
console.log(child1.colors); // ["red", "blue", "green", "black"]

var child2 = new Child('daisy', '20');

console.log(child2.name); // daisy
console.log(child2.age); // 20
console.log(child2.colors); // ["red", "blue", "green"]

```

#### åŸå‹å¼ç»§æ‰¿

```js
function createObj(o) {
    function F(){}
    F.prototype = o;
    return new F();
}
```

#### å¯„ç”Ÿå¼ç»§æ‰¿

```js
function createObj (o) {
    var clone = object.create(o);
    clone.sayName = function () {
        console.log('hi');
    }
    return clone;
}
```

#### å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿

```js
function Parent (name) {
    this.name = name;
    this.colors = ['red', 'blue', 'green'];
}

Parent.prototype.getName = function () {
    console.log(this.name)
}

function Child (name, age) {
    Parent.call(this, name);
    this.age = age;
}

Child.prototype = new Parent();

var child1 = new Child('kevin', '18');

console.log(child1)

```

#### Classå®ç°ç»§æ‰¿(è¡¥å……ä¸€ä¸‹)

```js
classÂ AnimalÂ {  
Â Â Â Â constructor(name)Â {  
Â Â Â Â Â Â Â Â this.nameÂ =Â name  
Â Â Â Â }Â   
Â Â Â Â getName()Â {  
Â Â Â Â Â Â Â Â returnÂ this.name  
Â Â Â Â }  
}  
classÂ DogÂ extendsÂ AnimalÂ {  
Â Â Â Â constructor(name,Â age)Â {  
Â Â Â Â Â Â Â Â super(name)  
Â Â Â Â Â Â Â Â this.ageÂ =Â age  
Â Â Â Â }  
}
```

### å®ç°object.create

```js
functionÂ newCreate(proto,Â propertiesObject)Â {  
Â Â Â Â ifÂ (typeofÂ protoÂ !==Â 'object'Â &&Â typeofÂ protoÂ !==Â 'function')Â {  
Â Â Â Â Â Â Â Â throwÂ TypeError('ObjectÂ prototypeÂ mayÂ onlyÂ beÂ anÂ Object:Â 'Â +Â proto)  
Â Â Â Â }  
Â Â Â Â functionÂ F()Â {Â }  
Â Â Â Â F.prototypeÂ =Â proto  
Â Â Â Â constÂ oÂ =Â newÂ F()  
  
Â Â Â Â ifÂ (propertiesObjectÂ !==Â undefined)Â {  
Â Â Â Â Â Â Â Â Object.keys(propertiesObject).forEach(propÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â letÂ descÂ =Â propertiesObject[prop]  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (typeofÂ descÂ !==Â 'object'Â ||Â descÂ ===Â null)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ TypeError('ObjectÂ prorotypeÂ mayÂ onlyÂ beÂ anÂ Object:Â 'Â +Â desc)  
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Object.defineProperty(o,Â prop,Â desc)  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â })  
Â Â Â Â }  
  
Â Â Â Â returnÂ o  
}
```

## ğŸš‚ Functionç¯‡

### call

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

```js
Function.prototype.myCallÂ =Â functionÂ (thisArg)Â {  
Â Â Â Â thisArgÂ =Â thisArgÂ ||Â window;  
Â Â Â Â thisArg.funcÂ =Â this;  
Â Â Â Â constÂ argsÂ =Â []  
Â Â Â Â forÂ (letÂ iÂ =Â 1;Â i<arguments.length;Â i++)Â {  
Â Â Â Â Â Â Â Â args.push('arguments['+Â iÂ +Â ']')  
Â Â Â Â }  
Â Â Â Â constÂ resultÂ =Â eval('thisArg.func('Â +Â argsÂ +')')  
Â Â Â Â deleteÂ thisArg.func;  
Â Â Â Â returnÂ result;  
}
```

### bind

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

```js
Function.prototype.sx_bindÂ =Â functionÂ (obj,Â ...args)Â {  
Â Â Â Â objÂ =Â objÂ ||Â window  
  
Â Â Â Â constÂ fnÂ =Â Symbol()  
Â Â Â Â obj[fn]Â =Â this  
Â Â Â Â constÂ _thisÂ =Â this  
  
Â Â Â Â constÂ resÂ =Â functionÂ (...innerArgs)Â {  
Â Â Â Â Â Â Â Â console.log(this,Â _this)  
Â Â Â Â Â Â Â Â ifÂ (thisÂ instanceofÂ _this)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â this[fn]Â =Â _this  
Â Â Â Â Â Â Â Â Â Â Â Â this[fn](...[...args,Â ...innerArgs])  
Â Â Â Â Â Â Â Â Â Â Â Â deleteÂ this[fn]  
Â Â Â Â Â Â Â Â }Â elseÂ {  
Â Â Â Â Â Â Â Â Â Â Â Â obj[fn](...[...args,Â ...innerArgs])  
Â Â Â Â Â Â Â Â Â Â Â Â deleteÂ obj[fn]  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â res.prototypeÂ =Â Object.create(this.prototype)  
Â Â Â Â returnÂ res  
}
```

### apply

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

```js
Function.prototype.myApplyÂ =Â functionÂ (thisArg,Â arr)Â {  
Â Â Â Â thisArgÂ =Â thisArgÂ ||Â window;  
Â Â Â Â thisArg.funcÂ =Â this;  
Â Â Â Â constÂ argsÂ =Â []  
Â Â Â Â forÂ (letÂ iÂ =Â 0;Â i<arr.length;Â i++)Â {  
Â Â Â Â Â Â Â Â args.push('arr['+Â iÂ +Â ']')  
Â Â Â Â }  
Â Â Â Â constÂ resultÂ =Â eval('thisArg.func('Â +Â argsÂ +')')  
Â Â Â Â deleteÂ thisArg.func;  
Â Â Â Â returnÂ result;  
}
```

### å®ç°æŸ¯é‡ŒåŒ–[JavaScript ä¸“é¢˜ä¹‹å‡½æ•°æŸ¯é‡ŒåŒ–](https://juejin.cn/post/6844903490771222542#heading-5)

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
// ç¬¬ä¸‰ç‰ˆ
function curry(fn, args, holes) {
    length = fn.length;

    args = args || [];

    holes = holes || [];

    return function() {

        var _args = args.slice(0),
            _holes = holes.slice(0),
            argsLen = args.length,
            holesLen = holes.length,
            arg, i, index = 0;

        for (i = 0; i < arguments.length; i++) {
            arg = arguments[i];
            // å¤„ç†ç±»ä¼¼ fn(1, _, _, 4)(_, 3) è¿™ç§æƒ…å†µï¼Œindex éœ€è¦æŒ‡å‘ holes æ­£ç¡®çš„ä¸‹æ ‡
            if (arg === _ && holesLen) {
                index++
                if (index > holesLen) {
                    _args.push(arg);
                    _holes.push(argsLen - 1 + index - holesLen)
                }
            }
            // å¤„ç†ç±»ä¼¼ fn(1)(_) è¿™ç§æƒ…å†µ
            else if (arg === _) {
                _args.push(arg);
                _holes.push(argsLen + i);
            }
            // å¤„ç†ç±»ä¼¼ fn(_, 2)(1) è¿™ç§æƒ…å†µ
            else if (holesLen) {
                // fn(_, 2)(_, 3)
                if (index >= holesLen) {
                    _args.push(arg);
                }
                // fn(_, 2)(1) ç”¨å‚æ•° 1 æ›¿æ¢å ä½ç¬¦
                else {
                    _args.splice(_holes[index], 1, arg);
                    _holes.splice(index, 1)
                }
            }
            else {
                _args.push(arg);
            }

        }
        if (_holes.length || _args.length < length) {
            return curry.call(this, fn, _args, _holes);
        }
        else {
            return fn.apply(this, _args);
        }
    }
}

var _ = {};

var fn = curry(function(a, b, c, d, e) {
    console.log([a, b, c, d, e]);
});

// éªŒè¯ è¾“å‡ºå…¨éƒ¨éƒ½æ˜¯ [1, 2, 3, 4, 5]
fn(1, 2, 3, 4, 5);
fn(_, 2, 3, 4, 5)(1);
fn(1, _, 3, 4, 5)(2);
fn(1, _, 3)(_, 4)(2)(5);
fn(1, _, _, 4)(_, 3)(2)(5);
fn(_, 2)(_, _, 4)(1)(3)(5)

```

### å®ç°é“¾å¼è°ƒç”¨[æ–‡ç« ](https://github.com/zcxiaobao/everyday-insist/blob/master/21interview/imitate/chainFunc.md)

```js

function Class1() {
    console.log('åˆå§‹åŒ–')
}
Class1.prototype.method = function(param) {
    console.log(param)
    return this
}
let cl = new Class1()
//ç”±äºnew åœ¨å®ä¾‹åŒ–çš„æ—¶å€™thisä¼šæŒ‡å‘åˆ›å»ºçš„å¯¹è±¡ï¼Œ æ‰€ä»¥this.methodè¿™ä¸ªæ–¹æ³•ä¼šåœ¨åŸå‹é“¾ä¸­æ‰¾åˆ°ã€‚
cl.method('ç¬¬ä¸€æ¬¡è°ƒç”¨').method('ç¬¬äºŒæ¬¡é“¾å¼è°ƒç”¨').method('ç¬¬ä¸‰æ¬¡é“¾å¼è°ƒç”¨')
```

### åå‡½æ•°(æ–‡ç« )[https://juejin.cn/post/6946022649768181774#heading-17]

```js
function partial(fn, ...args) {
    return (...arg) => {
        args[index] = 
        return fn(...args, ...arg)
    }
}

```

## ğŸŒ ajax ä¸ jsonp

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

### å®ç°ajax

```js
functionÂ ajax({  
Â Â Â Â url=Â null,  
Â methodÂ =Â 'GET',  
Â dataTypeÂ =Â 'JSON',  
Â asyncÂ =Â true}){  
Â returnÂ newÂ Promise((resolve,Â reject)Â =>Â {  
Â Â letÂ xhrÂ =Â newÂ XMLHttpRequest()  
Â Â xhr.open(method,Â url,Â async)  
Â Â xhr.responseTypeÂ =Â dataType  
Â Â xhr.onreadystatechangeÂ =Â ()Â =>Â {  
Â Â Â if(!/^[23]\d{2}$/.test(xhr.status))Â return;  
Â Â Â if(xhr.readyStateÂ ===Â 4)Â {  
Â Â Â Â letÂ resultÂ =Â xhr.responseText  
Â Â Â Â resolve(result)  
Â Â Â }  
Â Â }  
Â Â xhr.onerrorÂ =Â (err)Â =>Â {  
Â Â Â reject(err)  
Â Â }  
Â Â xhr.send()  
Â })  
}
```

### å®ç°jsonp

```js
constÂ jsonpÂ =Â ({Â url,Â params,Â callbackNameÂ })Â =>Â {  
Â Â Â Â constÂ generateUrlÂ =Â ()Â =>Â {  
Â Â Â Â Â Â Â Â letÂ dataSrcÂ =Â ''  
Â Â Â Â Â Â Â Â forÂ (letÂ keyÂ inÂ params)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (params.hasOwnProperty(key))Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â dataSrcÂ +=Â `${key}=${params[key]}&`  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â dataSrcÂ +=Â `callback=${callbackName}`  
Â Â Â Â Â Â Â Â returnÂ `${url}?${dataSrc}`  
Â Â Â Â }  
Â Â Â Â returnÂ newÂ Promise((resolve,Â reject)Â =>Â {  
Â Â Â Â Â Â Â Â constÂ scriptEleÂ =Â document.createElement('script')  
Â Â Â Â Â Â Â Â scriptEle.srcÂ =Â generateUrl()  
Â Â Â Â Â Â Â Â document.body.appendChild(scriptEle)  
Â Â Â Â Â Â Â Â window[callbackName]Â =Â dataÂ =>Â {  
Â Â Â Â Â Â Â Â Â Â Â Â resolve(data)  
Â Â Â Â Â Â Â Â Â Â Â Â document.removeChild(scriptEle)  
Â Â Â Â Â Â Â Â }  
Â Â Â Â })  
}
```

## ğŸ›« ES6ç¯‡

### å®ç°set

```js
classÂ SetÂ {  
Â Â constructor()Â {  
Â Â Â Â this.itemsÂ =Â {};  
Â Â Â Â this.sizeÂ =Â 0;  
Â Â }  
  
Â Â has(element)Â {  
Â Â Â Â returnÂ elementÂ inÂ this.items;  
Â Â }  
  
Â Â add(element)Â {  
Â Â Â Â if(!Â this.has(element))Â {  
Â Â Â Â Â Â this.items[element]Â =Â element;  
Â Â Â Â Â Â this.size++;  
Â Â Â Â }  
Â Â Â Â returnÂ this;  
Â Â }  
  
Â Â delete(element)Â {  
Â Â Â Â ifÂ (this.has(element))Â {  
Â Â Â Â Â Â deleteÂ this.items[element];  
Â Â Â Â Â Â this.size--;  
Â Â Â Â }  
Â Â Â Â returnÂ this;  
Â Â }  
  
Â Â clear()Â {  
Â Â Â Â this.itemsÂ =Â {}  
Â Â Â Â this.sizeÂ =Â 0;  
Â Â }  
  
Â Â values()Â {  
Â Â Â Â letÂ valuesÂ =Â [];  
Â Â Â Â for(letÂ keyÂ inÂ this.items)Â {  
Â Â Â Â Â Â if(this.items.hasOwnProperty(key))Â {  
Â Â Â Â Â Â Â Â values.push(key);  
Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ values;  
Â Â }  
}
```

### å®ç° map

```js
functionÂ defaultToString(key)Â {  
Â Â if(keyÂ ===Â null)Â {  
Â Â Â Â returnÂ 'NULL';  
Â Â }Â elseÂ ifÂ (keyÂ ===Â undefined)Â {  
Â Â Â Â returnÂ 'UNDEFINED'  
Â Â }Â elseÂ ifÂ (Object.prototype.toString.call(key)Â ===Â '[objectÂ Object]'Â ||Â Object.prototype.toString.call(key)Â ===Â '[objectÂ Array]')Â {  
Â Â Â Â returnÂ JSON.stringify(key);  
Â Â }  
Â Â returnÂ key.toString();  
}  
  
classÂ MapÂ {  
Â Â constructor()Â {  
Â Â Â Â this.itemsÂ =Â {};  
Â Â Â Â this.sizeÂ =Â 0;  
Â Â }  
  
Â Â set(key,Â value)Â {  
Â Â Â Â if(!this.has(key))Â {  
Â Â Â Â Â Â this.items[defaultToString(key)]Â =Â value;  
Â Â Â Â Â Â this.size++;  
Â Â Â Â }  
Â Â Â Â returnÂ this;  
Â Â }  
  
Â Â get(key)Â {  
Â Â Â Â returnÂ this.items[defaultToString(key)];  
Â Â }  
  
Â Â has(key)Â {  
Â Â Â Â returnÂ this.items[defaultToString(key)]Â !==Â undefined;  
Â Â }  
  
Â Â delete(key)Â {  
Â Â Â Â ifÂ (this.has(key))Â {  
Â Â Â Â Â Â deleteÂ this.items[key];  
Â Â Â Â Â Â this.size--;  
Â Â Â Â }  
Â Â Â Â returnÂ this;  
Â Â }  
  
Â Â clear()Â {  
Â Â Â Â this.itemsÂ =Â {}  
Â Â Â Â this.sizeÂ =Â 0;  
Â Â }  
  
Â Â keys()Â {  
Â Â Â Â letÂ keysÂ =Â [];  
Â Â Â Â for(letÂ keyÂ inÂ this.items)Â {  
Â Â Â Â Â Â if(this.has(key))Â {  
Â Â Â Â Â Â Â Â keys.push(key)  
Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ keys;  
Â Â }  
  
Â Â values()Â {  
Â Â Â Â letÂ valuesÂ =Â [];  
Â Â Â Â for(letÂ keyÂ inÂ this.items)Â {  
Â Â Â Â Â Â if(this.has(key))Â {  
Â Â Â Â Â Â Â Â values.push(this.items[key]);  
Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â returnÂ values;  
Â Â }  
}
```

## ğŸ¦‰ å…¶ä»–

### instanceof

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­â­)

```js
functionÂ instance_of(Case,Â Constructor)Â {  
Â Â Â Â //Â åŸºæœ¬æ•°æ®ç±»å‹è¿”å›false  
Â Â Â Â //Â å…¼å®¹ä¸€ä¸‹å‡½æ•°å¯¹è±¡  
Â Â Â Â ifÂ ((typeof(Case)Â !=Â 'object'Â &&Â typeof(Case)Â !=Â 'function')Â ||Â CaseÂ ==Â 'null')Â returnÂ false;  
Â Â Â Â letÂ CaseProtoÂ =Â Object.getPrototypeOf(Case);  
Â Â Â Â whileÂ (true)Â {  
Â Â Â Â Â Â Â Â //Â æŸ¥åˆ°åŸå‹é“¾é¡¶ç«¯ï¼Œä»æœªæŸ¥åˆ°ï¼Œè¿”å›false  
Â Â Â Â Â Â Â Â ifÂ (CaseProtoÂ ==Â null)Â returnÂ false;  
Â Â Â Â Â Â Â Â //Â æ‰¾åˆ°ç›¸åŒçš„åŸå‹  
Â Â Â Â Â Â Â Â ifÂ (CaseProtoÂ ===Â Constructor.prototype)Â returnÂ true;  
Â Â Â Â Â Â Â Â CaseProtoÂ =Â Object.getPrototypeOf(CaseProto);  
Â Â Â Â }  
}
```

### å®ç°åƒåˆ†ä½åˆ†éš”ç¬¦

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
varÂ strÂ =Â "100000000000",  
Â Â Â Â regÂ =Â /(?=(\B\d{3})+$)/g;  
str.replace(reg,Â ",")
```

### æŠŠä¸€ä¸ªJSONå¯¹è±¡çš„keyä»ä¸‹åˆ’çº¿å½¢å¼ï¼ˆPascalï¼‰è½¬æ¢åˆ°å°é©¼å³°å½¢å¼ï¼ˆCamelï¼‰[æ–‡ç« ](https://github.com/zcxiaobao/everyday-insist/blob/master/21interview/baseJS/_tocamel.md)

è€ƒå¯Ÿé¢‘ç‡: (â­â­â­)

```js
function getCamelCase(str) {
    return str.replace(/_([a-z])/g, function(all, i) {
        return i.toLowerCase();
    })
}
```

### å®ç°æ•°æ®ç±»å‹åˆ¤æ–­å‡½æ•°typeof[[typeof]]

```js
functionÂ myTypeof(obj)Â {  
Â Â Â returnÂ Object.prototype.toString.call(obj).slice(8,Â -1).toLowerCase()Â   
}
```

### å®ç°æ•°ç»„è½¬æ ‘[æ–‡ç« ](https://github.com/lgwebdream/FE-Interview/issues/35)

```js
function convert(list) {
  const map = list.reduce((acc, item) => {
    acc[item.id] = item
    return acc
  }, {})
  const result = []
  for (const key in map) {
    const item = map[key]
    if (item.parentId === 0) {
      result.push(item)
    } else {
      const parent = map[item.parentId]
      if (parent) {
        parent.children = parent.children || []
        parent.children.push(item)
      }
    }
  }
  return result
}
```

### å®ç°sleepå‡½æ•°

```js
//Â promise  
constÂ sleepÂ =Â timeÂ =>Â {  
Â Â returnÂ newÂ Promise(resolveÂ =>Â setTimeout(resolve,time))  
}  
sleep(1000).then(()=>{  
Â Â console.log(1)  
})  
//Â ES5  
functionÂ sleep(callback,time)Â {  
Â Â if(typeofÂ callbackÂ ===Â 'function')  
Â Â Â Â setTimeout(callback,time)  
}  
  
functionÂ output(){  
Â Â console.log(1);  
}  
sleep(output,1000);
```

### å®ç°å‘å¸ƒè®¢é˜…æ¨¡å¼

```js
classÂ EventEmitterÂ {  
Â Â Â Â constructor()Â {  
Â Â Â Â Â Â Â Â this.cacheÂ =Â {}  
Â Â Â Â }  
Â Â Â Â on(name,Â fn)Â {  
Â Â Â Â Â Â Â Â ifÂ (this.cache[name])Â {  
Â Â Â Â Â Â Â Â Â Â Â Â this.cache[name].push(fn)  
Â Â Â Â Â Â Â Â }Â elseÂ {  
Â Â Â Â Â Â Â Â Â Â Â Â this.cache[name]Â =Â [fn]  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â off(name,Â fn)Â {  
Â Â Â Â Â Â Â Â letÂ tasksÂ =Â this.cache[name]  
Â Â Â Â Â Â Â Â ifÂ (tasks)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â constÂ indexÂ =Â tasks.findIndex(fÂ =>Â fÂ ===Â fnÂ ||Â f.callbackÂ ===Â fn)  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (indexÂ >=Â 0)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tasks.splice(index,Â 1)  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â emit(name,Â onceÂ =Â false,Â ...args)Â {  
Â Â Â Â Â Â Â Â ifÂ (this.cache[name])Â {  
Â Â Â Â Â Â Â Â Â Â Â Â //Â åˆ›å»ºå‰¯æœ¬ï¼Œå¦‚æœå›è°ƒå‡½æ•°å†…ç»§ç»­æ³¨å†Œç›¸åŒäº‹ä»¶ï¼Œä¼šé€ æˆæ­»å¾ªç¯  
Â Â Â Â Â Â Â Â Â Â Â Â letÂ tasksÂ =Â this.cache[name].slice()  
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (letÂ fnÂ ofÂ tasks)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fn(...args)  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (once)Â {  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â deleteÂ this.cache[name]  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
}
```